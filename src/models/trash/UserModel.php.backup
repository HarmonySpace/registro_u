<?php
require_once __DIR__ . "/../../config/conn.php";
class UserModel extends Connection
{

	public function getUsers()
	{
		try {
			$query = "SELECT * FROM usuarios";
			$stmt = Connection::getConnection()->prepare($query);
			$stmt->execute();
			return $stmt->fetchAll(PDO::FETCH_ASSOC);
		} catch (PDOException $e) {
			echo $e->getMessage();
		}
	}
	public function getUser($id)
	{
		try {
			$query = "SELECT * FROM usuarios WHERE cod_usuario = :id";
			$stmt = Connection::getConnection()->prepare($query);
			$stmt->bindParam(':id', $id);
			$stmt->execute();
			return $stmt->fetch();
		} catch (PDOException $e) {
			echo $e->getMessage();
		}
	}
	public function postUser($data)
	{
		try {
			// the cod_usuario is generated by the database
			$query = "INSERT INTO usuarios (nombre, clave, cod_fac, fecha_creacion, usuario_creador, activo, tipo_menu) VALUES (:user_name, :user_key, :user_fac, :user_init, :user_creator, :user_active, :user_menu)";
			$stmt = Connection::getConnection()->prepare($query);
			$stmt->bindParam(':user_name', $data['user_name']);
			$stmt->bindParam(':user_key', $data['user_key']);
			$stmt->bindParam(':user_fac', $data['user_fac']);
			$stmt->bindParam(':user_init', $data['user_init']);
			$stmt->bindParam(':user_creator', $data['user_creator']);
			$stmt->bindParam(':user_active', $data['user_active']);
			$stmt->bindParam(':user_menu', $data['user_menu']);
			$stmt->execute();
		} catch (PDOException $e) {
			echo $e->getMessage();
		}
	}
	public function putUser($data)
	{
		try {
			$query = "UPDATE usuarios SET nombre = :user_name, clave = :user_key, cod_fac = :user_fac, fecha_creacion = :user_init, activo = :user_active, tipo_menu = :user_menu, usuario_creador = :user_creator WHERE cod_usuario = :user_code";
			$stmt = Connection::getConnection()->prepare($query);
			$stmt->bindParam(':user_code', $data['user_code']);
			$stmt->bindParam(':user_name', $data['user_name']);
			$stmt->bindParam(':user_key', $data['user_key']);
			$stmt->bindParam(':user_fac', $data['user_fac']);
			$stmt->bindParam(':user_init', $data['user_init']);
			$stmt->bindParam(':user_creator', $data['user_creator']);
			$stmt->bindParam(':user_active', $data['user_active']);
			$stmt->bindParam(':user_menu', $data['user_menu']);
			$stmt->execute();
		} catch (PDOException $e) {
			echo $e->getMessage();
		}
	}
}
